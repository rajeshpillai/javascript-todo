<!doctype HTML>
<html>

    <head>
        <title>My awesome todo application</title>
        
        <link href="css/site.css" rel="stylesheet"/>
    </head>

    <body>
      <h2>Pee Pee Poo Poo</h2>

      <h3>What do I want to do today?</h3>

      <form>
        <input id="todo" type="text" placeholder="my todo"/>

        <button onclick="addTodo()" type="button">Add Todo</button>

        <ul id="todos">

        </ul>

      </form>

      <script>
        var todos = [
          {id: 1, task: 'Get the training done!',status:true},
          {id: 2, task: 'Ensure everyone including me understands this',status:false},
          {id: 3, task: 'Be happy',status: false}
        ];


        refreshUI();
        
        
        function addTodo() {
          var todo = document.getElementById('todo').value;
          
          todos.push({id: todos.length+1, task: todo, status:false});
          
          console.log('TODOS: ', todos);
          
          refreshUI();
        }
        
        function refreshUI() {
          var elem = document.getElementById('todos');
          var html = "";
          
          var btnText = 'Complete';
          
          var btnStatus = "";
          
          for(var i = 0; i < todos.length; i++) {
            var todo = todos[i];
            var style = "";
            
            btnStatus = "<button type='button' onclick='toggleTodos(this)' class='btn'>Complete</button>";

            if (todo.status === true) {
              style = "todo-completed";
              btnStatus = "<button type='button' onclick='toggleTodos(this)' class='btn'>Undo</button>";
            }  
            
            html += "<li id=" + todo.id + " class=" + style + ">" + todos[i].task + btnStatus +  "</li>" ;
          }

          elem.innerHTML = html;
        }
        
        function toggleTodos(el) {
          //e.parentNode.className = "";
          el.parentNode.classList.remove("todo-completed");
          
          var todoId = el.parentNode.id;
          
          var todo = {};
          
          for(var i = 0; i < todos.length; i++){
            todo = todos[i];  
            if (todo.id  == todoId) {
              break;
            }
          }
          
          //alert(JSON.stringify(todo));
          
          todo.status = !todo.status;
          
          refreshUI();
          
        }

      </script>

    </body>
</html>
